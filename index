<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>แบบประเมินสุขภาพจิต 9Q &amp; 8Q</title>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&amp;display=swap" rel="stylesheet"/>
<style>
        /* Root variables for consistent theming */
        :root {
            --primary-color: #6A1B9A; /* Deep Purple - Main color */
            --secondary-color: #FFB300; /* Amber - Accent color */
            --accent-color: #00BCD4; /* Cyan - Highlight color */
            --bg-light: #F3E5F5; /* Light Purple Background */
            --bg-white: #FFFFFF;
            --text-dark: #333333;
            --border-color: #D1C4E9; /* Light Purple Border */
            --box-shadow-light: 0 6px 12px rgba(0,0,0,0.15);
            --button-hover-dark: #4A148C;
            --button-active-shadow: 0 2px 4px rgba(0,0,0,0.2);
            --warning-color: #FF5722; /* Deep Orange for warning/risk */
            --warning-bg: #FFCCBC; /* Lighter Deep Orange */
        }

        /* Basic body styling */
        body {
            font-family: 'Kanit', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* Main container for the form */
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: var(--bg-white);
            padding: 35px;
            border-radius: 15px;
            box-shadow: var(--box-shadow-light);
            border: 1px solid var(--border-color);
        }

        /* Headings styling */
        h1, h2 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 25px;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }

        h2 {
            margin-top: 45px;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 12px;
            display: inline-block;
            margin-left: auto;
            margin-right: auto;
            display: block;
            width: fit-content;
            font-size: 1.8em;
        }

        /* Horizontal rule styling */
        hr {
            border: none;
            border-top: 2px dashed var(--border-color);
            margin: 40px auto;
            width: 80%;
        }

        /* Form section general styling */
        .form-section {
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            background-color: #F8F4FA;
        }

        /* Form group (label + input) styling */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1em;
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"],
        .form-group input[type="number"],
        .form-group select {
            width: calc(100% - 24px); /* Adjust for padding */
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 17px;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="email"]:focus,
        .form-group input[type="tel"]:focus,
        .form-group input[type="number"]:focus,
        .form-group select:focus {
            border-color: var(--accent-color);
            outline: none;
            box-shadow: 0 0 8px rgba(0, 188, 212, 0.4); /* Cyan glow */
        }

        /* Consent box styling */
        .consent-box {
            background-color: #FFF9C4; /* Light Yellow for consent */
            border: 1px solid #FFEB3B; /* Yellow border */
            padding: 25px;
            border-radius: 12px;
            margin-top: 35px;
            margin-bottom: 35px;
            font-size: 1.05em;
            color: #795548;
            line-height: 1.8;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }

        .consent-box p {
            margin: 0 0 10px 0;
        }
        .consent-box p:last-child {
            margin-bottom: 0;
        }

        /* Question section styling */
        .question-section {
            margin-bottom: 28px;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }
        .question-section:hover {
            transform: translateY(-3px);
        }

        .question-section.odd {
            background-color: #E8F5E9; /* Pale Green */
            border-left: 6px solid #4CAF50; /* Green accent */
        }

        .question-section.even {
            background-color: #F8E0F7; /* Pale Pink/Purple */
            border-left: 6px solid #BA68C8; /* Medium Purple accent */
        }

        .question-section p {
            font-weight: 700;
            margin-bottom: 18px;
            color: var(--primary-color);
            font-size: 1.2em;
        }

        /* Radio button options styling */
        .question-options label {
            display: block;
            margin-bottom: 12px;
            cursor: pointer;
            padding: 12px 18px;
            border: 1px solid #DEDEDE;
            border-radius: 8px;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            color: var(--text-dark);
            font-size: 1.05em;
            background-color: var(--bg-white);
        }

        .question-options label:hover {
            background-color: #F0F0F0;
            border-color: var(--accent-color);
        }
        .question-options input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2); /* Make radio buttons a bit larger */
            vertical-align: middle;
        }
        .question-options input[type="radio"]:checked + span {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Button group styling */
        .button-group {
            text-align: center;
            margin-top: 40px;
        }

        /* General button styling */
        .btn {
            background-color: var(--primary-color);
            color: white;
            padding: 16px 35px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
            margin: 0 10px; /* Space between buttons if multiple */
        }

        .btn:hover {
            background-color: var(--button-hover-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: var(--button-active-shadow);
        }

        /* Specific style for "Submit Assessment" button */
        .btn.submit-assessment {
            background-color: var(--accent-color);
        }
        .btn.submit-assessment:hover {
            background-color: #0097A7; /* Darker Cyan */
        }

        /* Assessment results section styling */
        #assessment-results, #assessment-results-8q {
            margin-top: 50px;
            padding: 35px;
            background-color: #E0F7FA; /* Light Cyan result box */
            border: 1px solid #80DEEA;
            border-radius: 15px;
            text-align: center;
            display: none; /* Hide by default */
            box-shadow: var(--box-shadow-light);
        }

        #assessment-results h3, #assessment-results-8q h3 {
            color: var(--primary-color);
            font-size: 28px;
            margin-bottom: 25px;
            font-weight: 700;
        }

        #assessment-results p, #assessment-results-8q p {
            font-size: 1.15em;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        #assessment-results .score-display, #assessment-results-8q .score-display {
            font-size: 2.2em;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 10px;
        }
        #assessment-results .result-level, #assessment-results-8q .result-level {
            font-size: 1.5em;
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 25px;
        }

        /* Recommendation box styling */
        #assessment-results .recommendation, #assessment-results-8q .recommendation {
            background-color: #C8E6C9; /* Lighter Green for recommendation */
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
            text-align: left;
            color: #388E3C; /* Dark Green text */
            border: 1px solid #A5D6A7;
            font-size: 1.05em;
            line-height: 1.7;
        }

        #assessment-results .recommendation h4, #assessment-results-8q .recommendation h4 {
            margin-top: 0;
            color: #2E7D32;
            font-size: 1.25em;
            font-weight: 700;
            margin-bottom: 15px;
        }

        /* High risk styling for 8Q results */
        #assessment-results-8q.high-risk {
            background-color: var(--warning-bg);
            border-color: var(--warning-color);
        }
        #assessment-results-8q.high-risk h3 {
            color: var(--warning-color);
        }
        #assessment-results-8q.high-risk .score-display,
        #assessment-results-8q.high-risk .result-level {
            color: var(--warning-color);
        }
        #assessment-results-8q.high-risk .recommendation {
            background-color: #FFECB3; /* Lighter yellow-orange */
            border-color: #FFCA28;
            color: #E65100;
        }
        #assessment-results-8q.high-risk .recommendation h4 {
            color: #D84315;
        }

        /* Next step button styling */
        .next-step-button {
            background-color: var(--secondary-color);
            margin-top: 25px;
        }

        .next-step-button:hover {
            background-color: #FF8F00; /* Darker Amber */
        }
        .next-step-button.danger {
            background-color: var(--warning-color);
        }
        .next-step-button.danger:hover {
            background-color: #D84315;
        }

        /* Styling for the sub-question in 8Q */
        .sub-question-group {
            margin-top: 15px;
            padding-left: 20px;
            border-left: 3px solid var(--accent-color);
            background-color: #F0F8FF; /* Light blue for sub-question */
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .sub-question-group p {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                margin: 10px auto;
                padding: 20px;
            }
            h1 {
                font-size: 2em;
            }
            h2 {
                font-size: 1.5em;
            }
            .form-group input[type="text"],
            .form-group input[type="email"],
            .form-group input[type="tel"],
            .form-group input[type="number"],
            .form-group select {
                width: calc(100% - 20px);
                padding: 10px;
            }
            .question-section p {
                font-size: 1.1em;
            }
            .question-options label {
                padding: 10px 15px;
                font-size: 0.95em;
            }
            .btn {
                padding: 12px 25px;
                font-size: 1em;
                margin: 5px 0;
            }
            #assessment-results h3, #assessment-results-8q h3 {
                font-size: 24px;
            }
            #assessment-results p, #assessment-results-8q p {
                font-size: 1em;
            }
            #assessment-results .score-display, #assessment-results-8q .score-display {
                font-size: 1.8em;
            }
            #assessment-results .result-level, #assessment-results-8q .result-level {
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
<div class="container"><div style="text-align: right; margin-bottom: 15px;"><button class="btn" id="languageToggleBtn" style="background-color: var(--secondary-color);">EN / TH</button></div>
<h1>แบบประเมินสุขภาพจิต 9Q &amp; 8Q</h1>
<p id="introParagraph" style="text-align: center; font-size: 1.15em; color: var(--primary-color); font-weight: 500;">
<i style="color: var(--secondary-color);">✨</i> กรุณากรอกข้อมูลส่วนตัวและทำแบบประเมินเพื่อรับคำแนะนำด้านสุขภาพจิต
        </p>
<!-- Wrapper for the initial form section and related headings/buttons -->
<div id="initialFormWrapper">
<hr/>
<h2 id="personalInfoHeading" style="display: none;">ข้อมูลผู้เข้าร่วม</h2> <!-- Hidden by default as per request -->
<div class="form-section">
<form id="mentalHealthAssessmentForm">
<div class="form-group">
<label for="firstName">ชื่อ:</label>
<input id="firstName" name="firstName" placeholder="กรุณากรอกชื่อ" required="" type="text"/>
</div>
<div class="form-group">
<label for="lastName">นามสกุล:</label>
<input id="lastName" name="lastName" placeholder="กรุณากรอกนามสกุล" required="" type="text"/>
</div>
<div class="form-group">
<label for="gender">เพศ:</label>
<select id="gender" name="gender" required="">
<option value="">-- เลือกเพศ --</option>
<option value="ชาย">ชาย</option>
<option value="หญิง">หญิง</option>
<option value="อื่นๆ">อื่นๆ</option>
</select>
</div>
<div class="form-group">
<label for="age">อายุ:</label>
<input id="age" max="100" min="10" name="age" placeholder="กรุณากรอกอายุ" required="" type="number"/>
</div>
<div class="form-group">
<label for="status">สถานะ:</label>
<select id="status" name="status" required="">
<option value="">-- เลือกสถานะ --</option>
<option value="นักเรียน">นักเรียน</option>
<option value="นักศึกษา">นักศึกษา</option>
<option value="เจ้าหน้าที่">เจ้าหน้าที่</option>
<option value="อาจารย์">อาจารย์</option>
<option value="บุคคลทั่วไป">บุคคลทั่วไป</option>
</select>
</div>
<div class="form-group">
<label for="educationYear">ระดับชั้น/ปีการศึกษา:</label>
<select id="educationYear" name="educationYear" required="">
<option value="">-- เลือก --</option>
<option value="มัธยมต้น">มัธยมต้น</option>
<option value="มัธยมปลาย">มัธยมปลาย</option>
<option value="ปี 1">ปี 1</option>
<option value="ปี 2">ปี 2</option>
<option value="ปี 3">ปี 3</option>
<option value="ปี 4">ปี 4</option>
<option value="สูงกว่าปริญญาตรี">สูงกว่าปริญญาตรี</option>
<option value="อื่นๆ">อื่นๆ</option>
</select>
</div>
<div class="form-group">
<label for="faculty">คณะ/สถาบัน:</label>
<select id="faculty" name="faculty" required="">
<option value="">-- เลือกคณะ/สถาบัน --</option>
<optgroup label="สถาบันเทคโนโลยีพระจอมเกล้าเจ้าคุณทหารลาดกระบัง">
<option value="คณะวิศวกรรมศาสตร์">คณะวิศวกรรมศาสตร์</option>
<option value="คณะสถาปัตยกรรมศาสตร์">คณะสถาปัตยกรรมศาสตร์</option>
<option value="คณะครุศาสตร์อุตสาหกรรมและเทคโนโลยี">คณะครุศาสตร์อุตสาหกรรมและเทคโนโลยี</option>
<option value="คณะเทคโนโลยีการเกษตร">คณะเทคโนโลยีการเกษตร</option>
<option value="คณะวิทยาศาสตร์">คณะวิทยาศาสตร์</option>
<option value="คณะอุตสาหกรรมเกษตร">คณะอุตสาหกรรมเกษตร</option>
<option value="คณะเทคโนโลยีสารสนเทศ">คณะเทคโนโลยีสารสนเทศ</option>
<option value="วิทยาลัยนวัตกรรมการจัดการ">วิทยาลัยนวัตกรรมการจัดการ</option>
<option value="วิทยาลัยนานาชาติ">วิทยาลัยนานาชาติ</option>
<option value="วิทยาลัยแพทยศาสตร์นานาชาติสิรินธร">วิทยาลัยแพทยศาสตร์นานาชาติสิรินธร</option>
<option value="คณะทันตแพทยศาสตร์">คณะทันตแพทยศาสตร์</option>
<option value="คณะศิลปศาสตร์">คณะศิลปศาสตร์</option>
<option value="คณะบริหารธุรกิจ">คณะบริหารธุรกิจ</option>
<option value="วิทยาลัยวิศวกรรมสังคีต">วิทยาลัยวิศวกรรมสังคีต</option>
<option value="วิทยาลัยอุตสาหกรรมสร้างสรรค์">วิทยาลัยอุตสาหกรรมสร้างสรรค์</option>
<option value="วิทยาลัยนวัตกรรมและเทคโนโลยีการศึกษา">วิทยาลัยนวัตกรรมและเทคโนโลยีการศึกษา</option>
<option value="วิทยาลัยนานาชาติลาดกระบัง">วิทยาลัยนานาชาติลาดกระบัง</option>
</optgroup>
<optgroup label="สถาบันโคเซ็น">
<option value="KOSEN สจล.">KOSEN สจล.</option>
</optgroup>
<option value="สถาบันอื่น ๆ">สถาบันอื่น ๆ</option>
</select>
</div>
<div class="form-group">
<label for="phone">เบอร์โทรศัพท์:</label>
<input id="phone" name="phone" pattern="[0-9]{10}" placeholder="08XXXXXXXX" required="" type="tel"/>
<small style="color: #666; display: block; margin-top: 5px;">(ตัวอย่าง: 0812345678)</small>
</div>
<div class="form-group">
<label for="email">อีเมล:</label>
<input id="email" name="email" placeholder="you@example.com" required="" type="email"/>
</div>
</form>
</div>
<hr/>
<h2 id="consentHeading">คำชี้แจงก่อนทำแบบประเมิน (Consent Form)</h2>
<div class="consent-box" id="consentBox">
<p>ในการประเมินสุขภาพจิตนี้ ข้อมูลส่วนตัวและผลการประเมินของท่านจะถูกเก็บรักษาเป็นความลับอย่างสูงสุด และจะนำไปใช้เพื่อประโยชน์ในการประเมินสุขภาพจิตและให้คำแนะนำเบื้องต้นเท่านั้น ข้อมูลของท่านจะไม่ถูกเปิดเผยต่อสาธารณะโดยไม่ได้รับอนุญาต</p>
<p>การกดปุ่ม "เริ่มทำแบบประเมิน" ถือว่าท่านได้อ่านและเข้าใจข้อตกลงข้างต้น และยินยอมให้ใช้ข้อมูลของท่านตามวัตถุประสงค์ที่ระบุไว้</p>
</div>
<div class="button-group">
<button class="btn" id="startAssessmentBtn" type="button">เริ่มทำแบบประเมิน</button>
</div>
</div>
<div id="assessment-9q" style="display: none;">
<hr/>
<h2>แบบประเมิน 9Q</h2>
<p style="text-align: center; margin-bottom: 30px; font-size: 1.1em; color: var(--text-dark);">
<i style="color: var(--secondary-color);">🤔</i> ในช่วง 2 สัปดาห์ที่ผ่านมา ท่านมีอาการหรือรู้สึกเช่นไรบ้าง
            </p>
<form id="q9AssessmentForm">
<div class="question-section odd">
<p>1. เบื่อ ไม่สนใจ หรือไม่สนุกกับการทำอะไรเลย</p>
<div class="question-options">
<label><input name="q1" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q1" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q1" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q1" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section even">
<p>2. ไม่สบายใจ ซึมเศร้า ท้อแท้</p>
<div class="question-options">
<label><input name="q2" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q2" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q2" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q2" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section odd">
<p>3. หลับยาก หรือหลับๆ ตื่นๆ หรือหลับมากไป</p>
<div class="question-options">
<label><input name="q3" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q3" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q3" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q3" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section even">
<p>4. เหนื่อยง่าย หรือไม่ค่อยมีแรง</p>
<div class="question-options">
<label><input name="q4" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q4" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q4" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q4" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section odd">
<p>5. เบื่ออาหาร หรือกินมากเกินไป</p>
<div class="question-options">
<label><input name="q5" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q5" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q5" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q5" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section even">
<p>6. รู้สึกไม่ดีกับตัวเอง คิดว่าตัวเองล้มเหลว หรือทำให้ตนเองหรือครอบครัวผิดหวัง</p>
<div class="question-options">
<label><input name="q6" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q6" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q6" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q6" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section odd">
<p>7. สมาธิไม่ดี เวลาดูโทรทัศน์ ฟังวิทยุ หรือทำงานที่ต้องใช้สมาธิ</p>
<div class="question-options">
<label><input name="q7" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q7" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q7" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q7" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section even">
<p>8. พูดช้า ทำอะไรช้าลงจนคนอื่นสังเกตเห็นได้ หรือกระสับกระส่าย ไม่สามารถอยู่นิ่งได้</p>
<div class="question-options">
<label><input name="q8" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q8" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q8" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q8" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="question-section odd">
<p>9. คิดทำร้ายตัวเอง หรือคิดว่าถ้าตายไปจะดีกว่า</p>
<div class="question-options">
<label><input name="q9" required="" type="radio" value="0"/> <span>ไม่มีเลย</span></label>
<label><input name="q9" type="radio" value="1"/> <span>เป็นบางวัน 1-7 วัน</span></label>
<label><input name="q9" type="radio" value="2"/> <span>เป็นเกือบทุกวัน เกิน 7 วัน</span></label>
<label><input name="q9" type="radio" value="3"/> <span>เป็นทุกวัน</span></label>
</div>
</div>
<div class="button-group">
<button class="btn submit-assessment" type="submit">ดูผลการประเมิน 9Q</button>
</div>
</form>
</div>
<div id="assessment-results">
<h3><i style="color: var(--accent-color);">🎉</i> ผลการประเมิน 9Q</h3>
<p>คะแนนรวม: <span class="score-display" id="score-9q">0</span> คะแนน</p>
<p>ผลการประเมิน: <span class="result-level" id="resultLevel-9q"></span></p>
<div class="recommendation">
<h4><i style="color: #2E7D32;">💡</i> คำแนะนำ:</h4>
<p id="recommendationText-9q"></p>
</div>
<div class="button-group">
<button class="btn next-step-button" id="bookAppointmentBtn" style="display: none;" type="button">จองคิวพบผู้เชี่ยวชาญ</button>
<button class="btn next-step-button danger" id="goTo8QAssessmentBtn" style="display: none;" type="button">ทำแบบประเมิน 8Q ต่อ (ความคิดฆ่าตัวตาย)</button>
</div>
</div>
<div id="assessment-8q" style="display: none;">
<hr/>
<h2>แบบประเมิน 8Q (ความคิดฆ่าตัวตาย)</h2>
<p style="text-align: center; margin-bottom: 30px; font-size: 1.1em; color: var(--warning-color); font-weight: 500;">
<i style="color: var(--warning-color);">⚠️</i> กรุณาตอบคำถามเหล่านี้อย่างตรงไปตรงมา
            </p>
<form id="q8AssessmentForm">
<div class="question-section odd">
<p>1. คิดอยากตาย หรือ คิดว่าตายไปจะดีกว่า</p>
<div class="question-options">
<label><input name="q8a_1" required="" type="radio" value="1"/> <span>มี</span></label>
<label><input name="q8a_1" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="question-section even">
<p>2. อยากทำร้ายตัวเอง หรือ ทำให้ตัวเองบาดเจ็บ</p>
<div class="question-options">
<label><input name="q8a_2" required="" type="radio" value="2"/> <span>มี</span></label>
<label><input name="q8a_2" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="question-section odd">
<p>3. คิดเกี่ยวกับการฆ่าตัวตาย</p>
<div class="question-options">
<label><input name="q8a_3_main" required="" type="radio" value="6"/> <span>มี</span></label>
<label><input name="q8a_3_main" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
<div class="sub-question-group" id="q8a_3_sub_group" style="display: none;">
<p>ท่านสามารถควบคุมความอยากฆ่าตัวตายที่ท่านคิดอยู่นั้นได้หรือไม่ หรือบอกได้ไหมว่าคงจะไม่ทำตามความคิดนั้นในขณะนี้</p>
<div class="question-options">
<label><input name="q8a_3_sub" type="radio" value="0"/> <span>ได้</span></label>
<label><input name="q8a_3_sub" type="radio" value="8"/> <span>ไม่ได้</span></label>
</div>
</div>
</div>
<div class="question-section even">
<p>4. มีแผนการที่จะฆ่าตัวตาย</p>
<div class="question-options">
<label><input name="q8a_4" required="" type="radio" value="8"/> <span>มี</span></label>
<label><input name="q8a_4" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="question-section odd">
<p>5. ได้เตรียมการที่จะทำร้ายตนเองหรือเตรียมการจะฆ่าตัวตาย โดยตั้งใจว่าจะให้ตายจริงๆ ในช่วง 1 เดือน</p>
<div class="question-options">
<label><input name="q8a_5" required="" type="radio" value="9"/> <span>มี</span></label>
<label><input name="q8a_5" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="question-section even">
<p>6. ได้ทำให้ตนเองบาดเจ็บแต่ไม่ตั้งใจที่จะทำให้เสียชีวิต</p>
<div class="question-options">
<label><input name="q8a_6" required="" type="radio" value="4"/> <span>มี</span></label>
<label><input name="q8a_6" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="question-section odd">
<p>7. ได้พยายามฆ่าตัวตายโดยคาดหวัง/ตั้งใจที่จะให้ตาย</p>
<div class="question-options">
<label><input name="q8a_7" required="" type="radio" value="10"/> <span>มี</span></label>
<label><input name="q8a_7" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="question-section even">
<p>8. ตลอดชีวิต ท่านเคยพยายามฆ่าตัวตาย</p>
<div class="question-options">
<label><input name="q8a_8" required="" type="radio" value="4"/> <span>มี</span></label>
<label><input name="q8a_8" type="radio" value="0"/> <span>ไม่มี</span></label>
</div>
</div>
<div class="button-group">
<button class="btn submit-assessment" type="submit">ดูผลการประเมิน 8Q</button>
</div>
</form>
</div>
<div id="assessment-results-8q">
<h3><i style="color: var(--warning-color);">🚨</i> ผลการประเมิน 8Q</h3>
<p>คะแนนรวม: <span class="score-display" id="score-8q">0</span> คะแนน</p>
<p>ผลการประเมิน: <span class="result-level" id="resultLevel-8q"></span></p>
<div class="recommendation">
<h4><i style="color: #D84315;">❗</i> คำแนะนำ:</h4>
<p id="recommendationText-8q"></p>
</div>
<div class="button-group">
<button class="btn next-step-button" id="bookAppointment8QBtn" style="display: none;" type="button">จองคิวพบผู้เชี่ยวชาญ</button> <!-- New button for 8Q results -->
<button class="btn next-step-button danger" id="contactExpert8QBtn" style="display: none;" type="button">ติดต่อผู้เชี่ยวชาญทันที</button>
</div>
</div>
</div>
<script>
        // Define the Web App URL for Google Apps Script.
        // IMPORTANT: Replace 'YOUR_DEPLOYED_WEB_APP_URL_HERE' with the actual URL
        // obtained after deploying your Google Apps Script as a Web App.
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzqIQLIzFAe-2p6dCATgywadlovctmZ6XBIfQO5eiZeg70YpFPUAXdUerPEskmfZPXjUA/exec'; 

        document.addEventListener('DOMContentLoaded', () => {
            const startAssessmentBtn = document.getElementById('startAssessmentBtn');
            const mentalHealthAssessmentForm = document.getElementById('mentalHealthAssessmentForm');
            const assessment9QSection = document.getElementById('assessment-9q');
            const q9AssessmentForm = document.getElementById('q9AssessmentForm');
            const assessmentResults9Q = document.getElementById('assessment-results');
            const score9QDisplay = document.getElementById('score-9q');
            const resultLevel9QDisplay = document.getElementById('resultLevel-9q');
            const recommendationText9Q = document.getElementById('recommendationText-9q');
            const bookAppointmentBtn = document.getElementById('bookAppointmentBtn'); // 9Q booking button
            const goTo8QAssessmentBtn = document.getElementById('goTo8QAssessmentBtn');

            const assessment8QSection = document.getElementById('assessment-8q');
            const q8AssessmentForm = document.getElementById('q8AssessmentForm');
            const assessmentResults8Q = document.getElementById('assessment-results-8q');
            const score8QDisplay = document.getElementById('score-8q');
            const resultLevel8QDisplay = document.getElementById('resultLevel-8q');
            const recommendationText8Q = document.getElementById('recommendationText-8q');
            const bookAppointment8QBtn = document.getElementById('bookAppointment8QBtn'); // 8Q booking button
            const contactExpert8QBtn = document.getElementById('contactExpert8QBtn'); // 8Q emergency button

            // Get elements for initial page visibility control
            const introParagraph = document.getElementById('introParagraph');
            const initialFormWrapper = document.getElementById('initialFormWrapper');
            const personalInfoHeading = document.getElementById('personalInfoHeading'); // Get the heading
            const consentHeading = document.getElementById('consentHeading'); // Get the heading
            const consentBox = document.getElementById('consentBox'); // Get the consent box

            // 8Q specific elements for conditional display
            const q8a3MainRadios = document.querySelectorAll('input[name="q8a_3_main"]');
            const q8a3SubGroup = document.getElementById('q8a_3_sub_group');

            // Store user info and assessment results globally or pass them around
            let userData = {};
            let q9Score = 0;
            let q9Level = '';
            let q9Recommendation = '';
            let q8Score = 0;
            let q8Level = '';
            let q8Recommendation = '';


            // Function to show a custom alert/modal
            function showCustomAlert(message) {
                const alertBox = document.createElement('div');
                alertBox.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background-color: white;
                    padding: 30px;
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                    z-index: 1000;
                    text-align: center;
                    font-family: 'Kanit', sans-serif;
                    max-width: 80%;
                    min-width: 300px;
                    border: 2px solid var(--primary-color);
                `;
                alertBox.innerHTML = `
                    <p style="font-size: 1.2em; margin-bottom: 20px; color: var(--text-dark);">${message}</p>
                    <button class="btn" style="background-color: var(--primary-color); padding: 10px 20px; font-size: 1em;">ตกลง</button>
                `;
                document.body.appendChild(alertBox);

                const closeBtn = alertBox.querySelector('.btn');
                closeBtn.addEventListener('click', () => {
                    document.body.removeChild(alertBox);
                });
            }

            // Function to submit all collected data to Google Sheet
            async function submitFormDataToGoogleSheet() {
                // Collect personal info
                const formData = new FormData(mentalHealthAssessmentForm);
                userData = Object.fromEntries(formData.entries());

                // Combine all data
                const allData = {
                    ...userData,
                    q9_score: q9Score,
                    q9_level: q9Level,
                    q9_recommendation: q9Recommendation,
                    q8_score: q8Score,
                    q8_level: q8Level,
                    q8_recommendation: q8Recommendation
                };

                console.log("Data to be sent:", allData); // For debugging

                try {
                    console.log('Attempting to send data to Google Sheet...');
                    const response = await fetch(WEB_APP_URL, {
                        method: 'POST',
                        mode: 'no-cors', // Use 'no-cors' for simple POST to Apps Script Web App
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: new URLSearchParams(allData).toString()
                    });

                    // With 'no-cors', response.ok will always be true and response.json() will fail.
                    // We assume success if no network error.
                    console.log('Fetch request sent. Please check your Google Sheet for confirmation.');
                    // showCustomAlert('ข้อมูลถูกส่งไปยัง Google Sheet เรียบร้อยแล้ว!'); // Optional: show alert after submission

                } catch (error) {
                    console.error('Error submitting data to Google Sheet:', error);
                    showCustomAlert('เกิดข้อผิดพลาดในการส่งข้อมูลไปยัง Google Sheet: ' + error.message);
                }
            }


            // Event listener for "Start Assessment" button
            startAssessmentBtn.addEventListener('click', () => {
                if (mentalHealthAssessmentForm.checkValidity()) {
                    // Collect personal info when starting assessment
                    const formData = new FormData(mentalHealthAssessmentForm);
                    userData = Object.fromEntries(formData.entries());

                    // Hide initial page elements
                    if (introParagraph) introParagraph.style.display = 'none';
                    if (initialFormWrapper) initialFormWrapper.style.display = 'none';

                    // Show 9Q assessment section
                    assessment9QSection.style.display = 'block';
                    window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top
                } else {
                    // Trigger browser's validation messages
                    mentalHealthAssessmentForm.reportValidity();
                    showCustomAlert('กรุณากรอกข้อมูลส่วนตัวให้ครบถ้วนก่อนเริ่มทำแบบประเมิน');
                }
            });

            // Event listener for 9Q form submission
            q9AssessmentForm.addEventListener('submit', async (event) => {
                event.preventDefault(); // Prevent default form submission

                let currentScore9Q = 0;
                for (let i = 1; i <= 9; i++) {
                    const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                    if (selectedOption) {
                        currentScore9Q += parseInt(selectedOption.value);
                    } else {
                        showCustomAlert('กรุณาตอบคำถาม 9Q ให้ครบทุกข้อ');
                        return; // Stop submission if any question is unanswered
                    }
                }
                q9Score = currentScore9Q; // Store the score

                score9QDisplay.textContent = q9Score;

                // Reset button visibility for 9Q results
                bookAppointmentBtn.style.display = 'none';
                goTo8QAssessmentBtn.style.display = 'none';

                if (q9Score >= 19) {
                    q9Level = 'รุนแรงมาก';
                    q9Recommendation = 'ท่านมีความเสี่ยงสูงมากที่จะมีภาวะซึมเศร้าระดับรุนแรง ควรปรึกษาจิตแพทย์หรือผู้เชี่ยวชาญด้านสุขภาพจิตโดยเร็วที่สุด';
                    goTo8QAssessmentBtn.style.display = 'block'; // Force 8Q
                } else if (q9Score >= 13) {
                    q9Level = 'รุนแรงปานกลาง';
                    q9Recommendation = 'ท่านมีความเสี่ยงที่จะมีภาวะซึมเศร้าระดับปานกลาง ควรพิจารณาส่งพบจิตแพทย์เพื่อรับการตรวจวินิจฉัยเพิ่มเติม';
                    goTo8QAssessmentBtn.style.display = 'block'; // Force 8Q
                } else if (q9Score >= 7) {
                    q9Level = 'รุนแรงน้อย';
                    q9Recommendation = 'ท่านมีความเสี่ยงที่จะมีภาวะซึมเศร้าระดับน้อย ควรใส่ใจดูแลสุขภาพจิตของตนเอง หากอาการไม่ดีขึ้นหรือแย่ลง ควรปรึกษาผู้เชี่ยวชาญ และประเมินการฆ่าตัวตาย 8 คำถามต่อ';
                    bookAppointmentBtn.style.display = 'block'; // Show booking for low severity
                    goTo8QAssessmentBtn.style.display = 'block'; // Show 8Q
                } else { // totalScore9Q 0-6
                    q9Level = 'ไม่มีภาวะซึมเศร้า';
                    q9Recommendation = 'ท่านมีสุขภาพจิตที่ดี ไม่พบภาวะซึมเศร้า ควรดูแลรักษาสุขภาพจิตที่ดีนี้ต่อไป';
                    // No buttons displayed
                    // Only submit data if 9Q score is 0-6, as the assessment ends here for them
                    await submitFormDataToGoogleSheet(); 
                }

                resultLevel9QDisplay.textContent = q9Level;
                recommendationText9Q.textContent = q9Recommendation;

                // Hide 9Q assessment and show results
                assessment9QSection.style.display = 'none';
                assessmentResults9Q.style.display = 'block';
                window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top
            });

            // Event listener for "Go to 8Q Assessment" button
            goTo8QAssessmentBtn.addEventListener('click', () => {
                assessmentResults9Q.style.display = 'none';
                assessment8QSection.style.display = 'block';
                window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top
            });

            // Event listener for Q8a_3_main radio buttons to show/hide sub-question
            q8a3MainRadios.forEach(radio => {
                radio.addEventListener('change', () => {
                    if (document.querySelector('input[name="q8a_3_main"]:checked').value === '6') {
                        q8a3SubGroup.style.display = 'block';
                        // Make sub-question radios required when visible
                        q8a3SubGroup.querySelectorAll('input[type="radio"]').forEach(subRadio => {
                            subRadio.setAttribute('required', 'required');
                        });
                    } else {
                        q8a3SubGroup.style.display = 'none';
                        // Remove required attribute and uncheck sub-question radios when hidden
                        q8a3SubGroup.querySelectorAll('input[type="radio"]').forEach(subRadio => {
                            subRadio.removeAttribute('required');
                            subRadio.checked = false;
                        });
                    }
                });
            });


            // Event listener for 8Q form submission
            q8AssessmentForm.addEventListener('submit', async (event) => {
                event.preventDefault(); // Prevent default form submission

                let currentScore8Q = 0;
                // Q1
                const q8a1 = document.querySelector('input[name="q8a_1"]:checked');
                if (!q8a1) { showCustomAlert('กรุณาตอบคำถาม 8Q ข้อ 1'); return; }
                currentScore8Q += parseInt(q8a1.value);

                // Q2
                const q8a2 = document.querySelector('input[name="q8a_2"]:checked');
                if (!q8a2) { showCustomAlert('กรุณาตอบคำถาม 8Q ข้อ 2'); return; }
                currentScore8Q += parseInt(q8a2.value);

                // Q3 Main and Sub
                const q8a3Main = document.querySelector('input[name="q8a_3_main"]:checked');
                if (!q8a3Main) { showCustomAlert('กรุณาตอบคำถาม 8Q ข้อ 3'); return; }
                currentScore8Q += parseInt(q8a3Main.value); // Add score for main Q3

                if (q8a3Main.value === '6') { // If "มี" for main Q3
                    const q8a3Sub = document.querySelector('input[name="q8a_3_sub"]:checked');
                    if (!q8a3Sub) { showCustomAlert('กรุณาตอบคำถาม 8Q ข้อ 3 ย่อย'); return; }
                    currentScore8Q += parseInt(q8a3Sub.value); // Add score for sub Q3
                }

                // Q4 to Q8
                const q8Questions = ['q8a_4', 'q8a_5', 'q8a_6', 'q8a_7', 'q8a_8'];
                // Scores are already in the HTML value attributes for each radio button
                for (let i = 0; i < q8Questions.length; i++) {
                    const qName = q8Questions[i];
                    const selectedOption = document.querySelector(`input[name="${qName}"]:checked`);
                    if (!selectedOption) {
                        showCustomAlert(`กรุณาตอบคำถาม 8Q ข้อ ${i + 4}`); // +4 because we start from Q4
                        return;
                    }
                    currentScore8Q += parseInt(selectedOption.value);
                }
                q8Score = currentScore8Q; // Store the score


                score8QDisplay.textContent = q8Score;

                // Reset button visibility for 8Q results
                bookAppointment8QBtn.style.display = 'none'; // Default to hidden
                contactExpert8QBtn.style.display = 'none';

                if (q8Score >= 17) {
                    q8Level = 'รุนแรง';
                    q8Recommendation = 'ท่านมีแนวโน้มฆ่าตัวตายในปัจจุบันระดับรุนแรง กรุณาส่งต่อโรงพยาบาลที่มีจิตแพทย์ด่วน';
                    assessmentResults8Q.classList.add('high-risk');
                    bookAppointment8QBtn.style.display = 'block'; // Show booking button for severe risk
                    contactExpert8QBtn.style.display = 'block'; // Show emergency button for severe risk
                } else if (q8Score >= 9) {
                    q8Level = 'ปานกลาง';
                    q8Recommendation = 'ท่านมีแนวโน้มฆ่าตัวตายในปัจจุบันระดับปานกลาง ควรปรึกษาผู้เชี่ยวชาญด้านสุขภาพจิต';
                    assessmentResults8Q.classList.remove('high-risk'); // Ensure no high-risk styling
                    bookAppointment8QBtn.style.display = 'block'; // Show booking button for moderate risk
                } else if (q8Score >= 1) {
                    q8Level = 'น้อย';
                    q8Recommendation = 'ท่านมีแนวโน้มฆ่าตัวตายในปัจจุบันระดับน้อย ควรใส่ใจดูแลสุขภาพจิตของตนเอง หากมีอาการไม่สบายใจหรือคิดอยากทำร้ายตัวเองเกิดขึ้น ควรขอความช่วยเหลือทันที';
                    assessmentResults8Q.classList.remove('high-risk');
                    bookAppointment8QBtn.style.display = 'block'; // Show booking button for low risk
                } else { // totalScore8Q 0
                    q8Level = 'ไม่มี';
                    q8Recommendation = 'ท่านไม่มีแนวโน้มฆ่าตัวตายในปัจจุบัน ควรดูแลรักษาสุขภาพจิตที่ดีนี้ต่อไป';
                    assessmentResults8Q.classList.remove('high-risk');
                    // Both buttons remain hidden
                }

                resultLevel8QDisplay.textContent = q8Level;
                recommendationText8Q.textContent = q8Recommendation;

                // Hide 8Q assessment and show results
                assessment8QSection.style.display = 'none';
                assessmentResults8Q.style.display = 'block';
                window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top

                // Submit data after 8Q assessment is completed
                await submitFormDataToGoogleSheet();
            });

            // Update the bookAppointmentBtn (for 9Q results) to redirect to the specified URL
            bookAppointmentBtn.addEventListener('click', () => {
                window.location.href = 'https://outlook.office365.com/owa/calendar/GrowthMindCenter@kmitl.ac.th/bookings/';
            });

            // Update the bookAppointment8QBtn (for 8Q results) to redirect to the specified URL
            bookAppointment8QBtn.addEventListener('click', () => {
                window.location.href = 'https://outlook.office365.com/owa/calendar/GrowthMindCenter@kmitl.ac.th/bookings/';
            });

            // Placeholder for contacting expert (can be expanded)
            contactExpert8QBtn.addEventListener('click', () => {
                showCustomAlert('กรุณาติดต่อสายด่วนสุขภาพจิต 1323 หรือโรงพยาบาลที่ใกล้ที่สุดทันที');
            });
        });
    
// Translation Data
const translations = {
    th: {
        title: "แบบประเมินสุขภาพจิต 9Q & 8Q",
        intro: "✨ กรุณากรอกข้อมูลส่วนตัวและทำแบบประเมินเพื่อรับคำแนะนำด้านสุขภาพจิต",
        firstName: "ชื่อ:",
        lastName: "นามสกุล:",
        gender: "เพศ:",
        startBtn: "เริ่มทำแบบประเมิน",
        q9Title: "แบบประเมิน 9Q",
        q8Title: "แบบประเมิน 8Q (ความคิดฆ่าตัวตาย)"
    },
    en: {
        title: "Mental Health Assessment 9Q & 8Q",
        intro: "✨ Please fill in your personal information and take the assessment to receive mental health advice.",
        firstName: "First Name:",
        lastName: "Last Name:",
        gender: "Gender:",
        startBtn: "Start Assessment",
        q9Title: "9Q Assessment",
        q8Title: "8Q Assessment (Suicidal Thoughts)"
    }
};

// Current language
let currentLang = "th";

// Function to switch language
function switchLanguage() {
    currentLang = currentLang === "th" ? "en" : "th";
    const t = translations[currentLang];

    document.querySelector("h1").textContent = t.title;
    document.getElementById("introParagraph").textContent = t.intro;
    document.querySelector('label[for="firstName"]').textContent = t.firstName;
    document.querySelector('label[for="lastName"]').textContent = t.lastName;
    document.querySelector('label[for="gender"]').textContent = t.gender;
    document.getElementById("startAssessmentBtn").textContent = t.startBtn;
    document.querySelector('#assessment-9q h2').textContent = t.q9Title;
    document.querySelector('#assessment-8q h2').textContent = t.q8Title;
}

// Event Listener
document.getElementById("languageToggleBtn").addEventListener("click", switchLanguage);
</script>
</body>
</html>
